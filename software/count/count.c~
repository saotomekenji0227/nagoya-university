#include <stdio.h>
#include "txtfmt.h"
#include "count.h"

void count(char moji){
  static int mojinum = 0;
  static int linenum = 1;
  if( 0x20 <= moji && moji <= 0x7E ){ //ASCIIの範囲
    if( ( mojinum + 1 ) > MOJIMAX ){　//半角は1文字
	mojinum = MOJIFIRST;
      if( linenum >= LINEMAX ){
	linenum = LINEFIRST;
	  page();
	}
      linenum = line(linenum);
    }
  }else if( 0x7E < moji ){ //日本語
    if( ( mojinum + 2 ) > MOJIMAX ){ //全角は2文字
      if( linenum >= LINEMAX ){
	linenum = LINEFIRST;
	mojinum = MOJIFIRST;
	page();
      }
      linenum = line(linenum);
    }
  }else if( moji == 0x0A ){ //改行
    if( linenum >= LINEMAX ){
      linenum = LINEFIRST;
      mojinum = MOJIFIRST;
      page();
    }
    linenum = linehead(linenum);
  }else if( moji == 0x09 ){ //タブ
    if( ( mojinum + 1 ) > MOJIMAX ){　//半角は1文字
	if( linenum >= LINEMAX ){
	  linenum = LINEFIRST;
	  mojinum = MOJIFIRST;
	  page();
	}
      linenum = line(linenum);
    }
    tab(mojinum);
  }else if( moji == 0x0C ){ //改ページ
    
  }
  return;
}
